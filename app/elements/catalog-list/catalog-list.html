<!--
-->
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="/bower_components/paper-styles/paper-styles.html">
<link rel="import" href="/bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="/bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="/bower_components/neon-animation/neon-animations.html">
<link rel="import" href="list-view.html">
<link rel="import" href="sub-list-view.html">
<link rel="import" href="full-view.html">

<dom-module id="catalog-list">

    <style>
    :host {
        display: block;
    }
    neon-animated-pages {
        height: 100%;
    }
    </style>

    <template>
        <iron-ajax auto
            url="/data/collection/collections.json"
            handle-as="json"
            last-response="{{collectionData}}"></iron-ajax>

        <neon-animated-pages id="pages" selected="0">

            <list-view
                data="[[collectionData]]"
                selected="{{selectedCategory}}"
                on-item-click="onCategoryClick"></list-view>

            <sub-list-view
                category="{{selectedCategory}}"
                data="[[selectedCategory.categories]]"
                sub-selected="{{selectedSubCategory}}"
                on-item-click="onSubCategoryClick"
                on-back="onSubCategoryBack"
                entry-animation="slide-from-right-animation"></sub-list-view>

            <full-view
                on-close="onSubCategoryClose"
                selected="{{selectedSubCategory}}"></full-view>

        </neon-animated-pages>
    </template>

</dom-module>
<script>
Polymer({

    is: 'catalog-list',

    properties: {

    },

    handleResponse: function(data) {
        console.log('handleResponse', data);
    },

    onCategoryClick: function(event) {
        var category = event.detail.item;
        console.log('onCategoryClick', category);
        if( category.categories ) {
            this.selectedCategory = category;
            this.$.pages.selected = 1;
        }
        else {
            this.selectedSubCategory = category;
            this.$.pages.selected = 2;
        }

    },

    onSubCategoryClick: function(event) {
        var subCategory = event.detail.item;
        console.log('onSubCategoryClick', subCategory);
        this.selectedSubCategory = subCategory;
        this.$.pages.selected = 2;
    },

    onSubCategoryBack: function(event) {
        this.$.pages.selected = 0;
    },

    onSubCategoryClose: function() {
        this.$.pages.selected--;
    }

});
</script>
